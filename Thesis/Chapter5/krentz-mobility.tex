\chapter{Handling Reboots and Mobility in 802.15.4 Security}
\label{chp:krentz-mobility}

AKES. Allow nodes to leave and join network. Discover new neighbours. Reboot.




\begin{figure}[h]
\begin{tcolorbox}[title=Three-way handshake in AKES]
\begin{align*}
U:\ & Generate\ R_u\ randomly\\
U \rightarrow *:\ & \texttt{HELLO}\langle{PAN_u, ID_u, R_u, C_u}\rangle{}\\
V:\ & K_{v,u}\ from\ pluggable\ scheme\\
V:\ & Generate\ R_v\ randomly.\ Wait\ for\ T_w \leq M_w\\
V:\ & K'_{v,u}\ =\ AES(K_{v,u}, R_u || R_v)\\
V \rightarrow U:\ & \texttt{HELLOACK}\langle{PAN_u, ID_u, PAN_v, ID_v, R_v, I_{u,v}, C_v, P_u}\rangle{K_{v,u}}\\
U:\ & K_{u,v}\ from\ pluggable\ scheme\\
U:\ & K'_{u,v}\ =\ AES(K_{u,v}, R_u || R_v)\\
U \rightarrow V:\ & \texttt{ACK}\langle{PAN_v, ID_v, PAN_u, ID_u, I_{v,u}, C_u}\rangle{K'_{u,v}}
\end{align*}
\end{tcolorbox}
\caption{Figure of the messages sent between communicating parties during \gls{akes}' three-way handshake. $\langle{msg}\rangle{K}$ indicates that the frame is authenticated using the key $K$.}
\label{fig:akes-handshake}
\end{figure}
