\chapter{Scyther Scripts}
\label{app:listings}


\section{Adaptable Pairwise Key Establishment Scheme (APKES)}
\label{app:apkes}

\lstinputlisting{scripts/apkes.spdl}

\section{Adaptable Key Establishment Scheme (AKES)}
\label{app:akes}

\lstinputlisting{scripts/akes.spdl}

\section{Secure Authentication and Key Establishment Scheme (SAKES)}
\label{app:sakes}

\subsection{SAKES - Authentication}
\label{app:sakes-auth}
\lstinputlisting{scripts/sakes-auth.spdl}

\subsection{SAKES - Key Establishment}
\label{app:sakes-keys}
%\lstinputlisting{scripts/sakes.spdl}

\section{Secure Authentication and Key Establishment Scheme (SAKES) --- Improved}
\label{app:sakes-fixed-auth}
\lstinputlisting{scripts/fix/sakes-auth-fix.spdl}

\chapter{Attacks}

\begin{figure}[h]
	\centering
	\includegraphics[scale=0.20, angle=90]{analysis/sakes-auth-a-weakagree-attack.png}
	\caption{Graph of the attack discovered on the weakagree property of the role A in the authentication phase of SAKES.}
	\label{fig:sakes-attack-weakagree}
\end{figure}

\begin{figure}[h]
	\centering
	\includegraphics[scale=0.20, angle=90]{analysis/sakes-auth-a-nisynch-attack.png}
	\caption{Graph of the attack discovered on the nisynch property of the role A, B, and C in the authentication phase of SAKES.}
	\label{fig:sakes-attack-nisynch}
\end{figure}

\chapter{Notations}

\section{Notations}
\label{app:notations}

\begin{tcolorbox}[title=Notations used in protocol specifications]
\begin{tabular}{ll}
\multicolumn{1}{p{1.3cm}}{\textbf{Symbol}} & \multicolumn{1}{p{4cm}}{\textbf{Meaning}}\\
A, B, C, D & Nodes\ A, B, C, D\\
$\langle{\ ...\ }\rangle{}$ & Unauthenticated message\\
$\langle{\ ...\ }\rangle{k}$ & Authenticated message with key $k$\\
$\{\ ...\ \}_k$ & Message encrypted with key $k$\\
$A \rightarrow B$ & Message sent from A to B\\
$A \rightarrow *$ & Message broadcasted from A\\
$(Pk_{node}, Sk_{node})$ & Public key pair for a node \\
$ID_{node}$ & Identity of a node\\
$AES(k, m)$ & AES encryption of message $m$ with key $k$\\
$N_{node}$ & Cryptographic nonce generated by a node\\
$X\ ||\ Y$ & Concatenation of two terms X and Y\\ 
\end{tabular}
\end{tcolorbox}


