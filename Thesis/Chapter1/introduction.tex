\chapter{Introduction}
\label{chp:introduction} 


\section{Motivation}


Information is the new natural resource. It is around us at all times, the possibilities of reshaping it into value are endless, and it is renewable. All we need to do is capture it. Computer devices equipped with sensors can capture a particular property of the physical world, and convert it into information. The information can then be exchanged with other devices, processed, computed on, or transformed into something new. To collect as much information as possible, we need a significant amount of these devices, and they need to be able to communicate with each other through networks. 

Our information is valuable. Therefore, we need to secure the data that we capture to protect it from possible adversaries that would want to steal, alter, or delete our precious information. Information can be secured by encrypting it, which would make the data look like nonsense to adversaries that intercept it. However, before a device is capable of encrypting its outgoing information stream, it needs to agree upon some key scheme to use for the encryption-decryption process. This is done through key establishment. 

There exist numerous well-tested and deployed protocols for key establishment in wireless networks. These are not, however, always well-suited for device-to-device communication where the devices are meant to be cheap and energy-efficient. Therefore, the community needs to rethink their approach when it comes to key establishment schemes for sensor networks.

Protocols for key establishment in device-to-device networks is an emerging market and involves multiple different network technologies and standards. While in the chase of creating energy efficient and universal key establishment schemes, the security analysis may not always be conducted properly or conducted at all. As the key establishment schemes become more sophisticated and complex, it may be difficult for humans to verify that a scheme is correct and does not contain any states that may cause the scheme to misbehave.

To avoid insecure protocols being standardized and deployed, which has repeatedly happened, formal security analysis is often conducted to verify that the protocol is, in fact, correct. Over the recent years, multiple tools for formal security analysis have been developed and made available to the public. By using these tools it is possible to verify security protocols by allowing a machine to explore each possible state of the protocol to expose possible malicious behaviour. Formally security analysis is something that any protocol should be exposed to, but is surprisingly often omitted. Hence, it would be interesting to explore proposed protocols for key establishment in \gls{6lowpan} in a formal way to verify that they provide the alleged security stated in their proposal.

\section{Scope and Objectives}

The scope of this thesis is to give a formal security analysis of the three key establishment protocols APKES, AKES, and SAKES by using the tool Scyther. These protocols are utilizing the \gls{ieee} 802.15.4 standard in conjunction with \gls{6lowpan}, which allows for connecting devices to each over the \gls{ip}. In addition to formally verifying the protocols, improvements of the protocols should be suggested. 

\subsection{Objectives}

This thesis has had three main objectives:

\begin{list}{â€¢}{}

\item Find and review three proposed protocols for key establishment in \gls{ieee} 802.15.4

\item Perform formal security analysis of the protocols

\item Propose improvements to the protocols

\end{list}

%* Review three protocols for key establishment in device-to-device communication.
%* Formally verify the protocols using a formal security analysis tool.
%* Deviation from original problem description.


\section{Methodology}

The first part of this thesis presents a background study of wireless networks such as the \gls{ieee} 802.15.4 and the \gls{6lowpan} to understand better how they provide different types of security services. Also, various key establishment architectures have been assessed to increase the understanding the properties that are desirable for key establishment schemes in a sensor network setting.

To be able to formally analyse key establishment protocols, a part of the thesis has involved learning how to implement and verify security protocols using the formal security tool known as Scyther. This includes understanding the connection between security properties for key establishment and how Scyther interprets and verifies these properties.

Three protocols for key establishment without any previous formal security analysis have been chosen for this thesis. These are reviewed and discussed to establish their various security properties, as well as security properties that they \textit{should} possess. The protocols have been modelled and formally verified by using the Scyther tool. When Scyther checks a protocol, it returns a table of all the claimed security properties and an indication of whether the property was successfully verified or falsified. In the event of a property being falsified, the attacks have been inspected, and changes to the protocol have been made to achieve the claimed security property. 

\section{Contribution}

The contribution of this thesis is, to the author's knowledge, the first published formal security analysis of APKES, AKES, and SAKES, which are key establishment protocols for 802.15.4 networks that utilize \gls{6lowpan}. In addition to formally verifying these protocols, the thesis also suggests improvements of the protocols, and explains their applicability for use in real world networks.

% More

\section{Outline}

In Chapter \ref{chp:background}, a general background is given on the Internet of Things and wireless sensor technology. It covers the general idea of key establishment, its security properties, and why it is challenging in an \gls{iot} context. The chapter also contains a brief overview of formal security analysis and the importance of conducting such analysis of modern security protocols.

Chapter \ref{chp:scyther} is an introduction to the formal security analysis tool known as Scyther. It explains how it works, and what types of security properties can be formally verified using the tool. In addition to the overall description, the chapter also contains examples of Scyther syntax, how we can model security protocols using the tool, and how to interpret the results of the verification process.

APKES, AKES, and SAKES are introduced in Chapter \ref{chp:protocols}, along with their specifications and weaknesses. These are recently proposed protocols that aim to provide secure key establishment in 802.15.4 networks that utilize \gls{6lowpan}.

Chapter \ref{chp:analysis} describes the formal security analysis of the protocols, how the protocols have been modelled in Scyther, and how the different security properties are assessed. The chapter also contains the results of the verification process with a brief explanation.

The results of the formal security analysis are discussed and compared in Chapter \ref{chp:discussion}, which also contains suggestions on how to improve the protocols.  In chapter \ref{chp:conclusion}, concluding remarks of the thesis and its contribution are presented. The thesis also comes with an appendix which contains the scripts of the modelled protocols, the attacks that is presented by Scyther, and an overview of the notations that are used when describing the protocols in detail.