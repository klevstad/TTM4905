\chapter{Background}
\label{chp:background}

\section{Internet of Things}
\label{sec:iot}

% Bruke gls p√• iot?
Over the last decade, a concept called the \emph{Internet of Things} has gained increased attention, both from the research community and commercial actors, as well as from consumers. The term \gls{iot} was, accordingly to most sources, coined in 1999 by the British visionary Kevin Ashton in a presentation about \gls{rfid} \cite{iot-phrase-2} \cite{iot-phrase-1}. Ashton's definition of the concept was a world where computers do not depend on human beings to provide them with information. Out of all the petabytes of information available on the Internet, the majority has been created and captured by humans performing some sort of action. In his opinion, \gls{iot} is about providing computers with the ability to gather information on their own.




%Another vision of the \gls{iot} is based upon the mixing of captured sensor data and connection of physical things to the Internet. 

% Bedre dette

A computational device containing some sort of sensor is attached to your everyday physical device, creating a bridge between our physical world and the cyber world \cite{Kopetz2011}. The connection to the Internet allows us to monitor and control these devices and sensors from a remote distance. Another vital part of \gls{iot} is device-to-device communications, essentially enabling devices to communicate with each other without human aid, and exchange and retrieve information. Such devices could be sensors monitoring some operation, a physical area, or even attached to a physical body. The possibilities are more or less unlimited. Imagine a home automation and surveillance system for your cabin, where lights, heaters, smoke detectors, underfloor heating, motion detectors, security cameras, garage and so on, are all interconnected with each other through small wireless devices. As it is called the \emph{internet} of things for a reason, your system and devices would be accessible over the Internet, allowing you to monitor the current status of your cabin remotely from your couch at home, as well as looking at historical data of the different sensors and devices. When the weekend arrives and you head for the mountains, the \gls{iot} provides you with an opportunity to preheat different (or all) sections of the cabin, deactivate the alarm, and perhaps instruct the sauna to start getting cosy. 

Another approach is to avoid using a monitor to remotely control the system, and instead allowing the system to observe and act on your behaviour. We want the devices to know us and figure out the correct thing to do without us telling them. For example, when pulling your car into the driveway, you want the garage door that is connected with your car to open up. The garage notifies your front door that you are home, which conveniently unlocks and notifies your house to turn on the lights in your hallway and perhaps the heater in your living room.


% Where is it going


The possibilities that are revealed as the \gls{iot} grows larger and the services expand are infinite. The concept is highly applicable for different scenarios involving home automation, standalone consumer products, industrial and environmental facilities, as well as medical surveillance. While larger automation systems for homes and facilities have been the target for the research community and early adopters, the consumer market has been focused on so-called \emph{wearables}. Wearables are fundamentally devices that you wear, such as smart watches, fitness trackers, virtual reality glasses, headphones, and smart clothing. Such human-centric devices are less about automation, and more focused on personal improvement. Nevertheless, the increase in \gls{iot} devices possibly provides us with a more cost efficient future, both in our use of time, as well as energy and consumption of other resources.


% Security challenges
As the \gls{iot} is built upon the Internet, it faces the same types of security issues as the Internet itself. The amount of ``things'' connected to the Internet is calculated to be 6.4 billions by the end of 2016, which is almost a 30\% increase from 2015. By 2020, the expected number of these ``things'' is more than 20 billion \cite{iot-gartner}, providing attackers with equally many possible devices to attack. Given the knowledge that some of these devices may be medical (or have other sensitive applications), we quickly recognize potential catastrophic scenarios.


The \gls{iot} architecture can resemble the neural system of the human body. The perception layer controls our sensors which we use to obtain information about our environment by observing, feeling, smelling, tasting or hearing. As previously described, \gls{iot} devices are often deployed with one or more sensors to perform these ``human operations'' for information collection. The perception layer is mainly focusing on sensing and allowing \gls{iot} devices to observe their environment and collect information. Examples of such technologies are \gls{rfid}, \gls{wsn}, and the \gls{gps} \citep{Jing2014}. Information from our human sensors are carried to the brain through a neural network. Much alike in \gls{iot}, the collected information is transmitted using the transportation layer. The transportation layer is running over some wireless or wired medium such as 802.15.4, \gls{6lowpan}, 3G, Bluetooth or Infrared. Finally the information is processed by an intelligent entity. In our human body example, this would be the brain. In the \gls{iot}, the brain would be an intelligent processing unit in the application layer which is able to compute and evaluate actions based on the received information \cite{iot-layers2012} \cite{iot-layers2010}. The application layer is also responsible for controlling the sensors, and performing global system management, and present data for the end user of the system.

As these layers covers different characteristics of \gls{iot}, they consists of different types of hardware and provide different types of services, hence they are subject to different types of security threats and solutions. The most adjacent problems to the scope of this thesis are the problems related to key establishment and key management, which define how two devices safely can establish secure communication between each other. Or in other words, how collected information is safely transmitted between the sensors and the ``brain''. 

%The \gls{iot} architecture is divided into three layers: perception, transportation and application, each addressing different types of security \cite{Jing2014}. Transportation and application layers, however, are out of scope for this project. The perception layer is mostly about sensors and other nodes that collect information from their environment, and communicate it throughout the transport network. Another goal for the layer is to pass control messages received. Examples of such technologies are \gls{rfid}, \gls{wsn}, and the \gls{gps}, each dealing with their own security problems and solutions. 



In an \gls{iot} world, the protection of data and privacy is an essential part. As previously mentioned, \gls{iot} technology may be a solution for problems involving sensitive information. In a medical facility, a possible scenario could be a \gls{wsn}, which is a dynamic and bi-directional network of nodes where each node has one or more sensors connected to it. A patient may have sensors implanted in their body, as well as different instruments attached for measuring different properties. All these devices communicate with each other wirelessly, and the network is therefore a possible target for an attacker. To prevent the attacker from eavesdropping, and possible forging content in the network, encryption and authentication at the different nodes is crucial.



% More motivation for the need for key management/establishment in \gls{iot}?


% Authentication. Encryption. 



\section{The IEEE 802.15.4 Standard}
\label{sec:802154}

Following the evolution of \gls{iot}, the need for cheap devices to communicate efficiently between each other has arisen. Existing architectures such as 802.11 (WiFi) and Bluetooth are too expensive in terms of processing and energy consumption, as the idea of \gls{iot} is to connect even the smallest devices to a network or Internet. As these devices are small, they have a limited battery life, and hence need to use energy in a highly efficient matter.

\begin{figure}[h]
	\centering
	\includegraphics[scale=0.65]{osi.png}
	\caption{The \gls{osi} stack with layers, the data they carry, and an example of technology running on the different layers.}
	\label{fig:osi}
\end{figure}

Protocols using the \gls{ieee} 802.15.4 standard are envisioned for applications supporting smart homes, medical surveillance, monitoring systems for environmental and industrial systems, as well as sensor systems for heating and ventilation. As we know from the \gls{iot}, it is really the imagination that puts an end to the possibilities for interconnected devices. The \gls{osi} stack defines the internal structure of communications systems, and is shown in Figure \ref{fig:osi}. As the 802.15.4 standard only defines the physical and data link layer of the \gls{osi} stack, which can be seen in Figure \ref{fig:osi}, specifications need to be developed to utilize the possibilities provided by 802.15.4 in the upper layers. ZigBee \cite{zigbee}, maintained by the ZigBee Alliance, is the most notable example of specifications that uses 802.15.4 as its base. Others include WirelessHART \citep{wirelesshart}, MiWi \cite{miwi}, and ISA100.11a \cite{isa100}.

The fundamental intention of the 802.15.4 standard is to provide low-rate, low-power communication between devices within a sensor network or \gls{wpan}. Its main use case is to let multiple devices within a short range communicate with each other over a low-rate radio, while maintaining a modest energy consumption. Figure \ref{fig:802154-figure} paints a picture of what 802.15.4 is, compared to more well-established concepts such as WiFi (802.11) and Bluetooth, focusing on energy consumption, complexity and date rate. While being smaller and more cost efficient than those found in more complex networks, devices running on 802.15.4 networks have a much more limited range (about 10 meters), and in most cases a throughput below 250 Kbps \cite{gutierrez2001ieee}. Not only is the 802.15.4 standard significantly lighter in terms of data rate and power consumption, it is also aimed at a different market than regular \gls{wpan}s. \gls{wpan}s are oriented around a person, creating a personal network for the user, which has higher demands to data rate, and can allow a higher energy consumption. 802.15.4, however, focuses on interconnecting devices that do not necessary have this constraint, such as industrial and medical applications. 


\begin{figure}[h]
	\centering
	\includegraphics[scale=0.45]{802154.png}
	\caption{Figure of IEEE 802.15.4's operational space compared to other wireless standards \cite{gutierrez2001ieee}.}
	\label{fig:802154-figure}
\end{figure}

Four basic security services are provided in the 802.15.4 link-layer security package, namely access control, message integrity, message confidentiality, and replay protection (sequential freshness) \cite{sastry2004security}. The \gls{ieee} 802.15.4 standard is delivered with a total of eight different security suites, providing none, some, or all of the described security services, and it is up to the application designer to specify and enable the desired security properties. In the most secure end of the scale we find \gls{aes}-\gls{ccm}, which is encryption using the block cipher \gls{aes} with either 32, 64 or 128-bit \gls{mac-auth}. Such a suite provides both strong encryption and possibly unforgeable messages (a 64-bit \gls{mac-auth} gives an adversary a $2^{-64}$ chance of successfully forging a message, and is used to enable legitimate nodes in the network to detect if a received message have been tampered with). On the other end of the scale we find a suite providing only confidentiality using \gls{aes} in \gls{ctr} mode. This suite does not, however, provide any form of authentication -- giving adversaries the possibility to forge messages, which can not be said to be especially secure. One of the things the 802.15.4 standard does not specify is how to deal with key establishment and key management, which therefore has to be dealt with in the higher layers.


% HER ER DET R√ÜV

% Flytte til key establishment?

%There exists multiple keying models, which essentially are descriptions on what type of key a node uses to communicate with other nodes. Examples of such models include network shared keying, where the entire network share the same symmetric key, and pairwise keying, where each node pair agree upon a key for them to use when communicating with each other. Over the years, many different proposals have surfaced regarding the most secure and efficient way of establishing keys between nodes, and how to perform key management. Some of them have been good, some of them not so good. The Diffie-Hellman Key Exchange is perhaps one of the more successful ... However, recent result 


% Gi konkrete eksempler.
% Gode: Diffie-Hellman Key Exchange
% D√•rlige: 



\section{6LoWPAN: Putting IP on Top of 802.15.4}
\label{sec:6lowpan}

% We want to reach our devices over the Internet. IP is the thing.

Initially, the \gls{ip} was considered to be too ``heavy'' for low-power wireless networks such as the ones described by the 802.15.4 standard. The idea of implementing \gls{ip} on top of 802.15.4 networks was born as early as 2001 under the question ``Why invent a new protocol when we already have IP?''\cite{Mulligan2007}. With \gls{ip}, the community already had a bundle of existing protocols for management, transport, configuring and debugging, such as \gls{snmp}, \gls{tcp} and \gls{udp}, as well as standardized services for higher layers such as caching, firewalls, load balancing, and mobility. Nevertheless, the initial idea of using \gls{ip} in combination with sensor networks or \gls{wpan}s was not accepted by various groups such as ZigBee \cite{Mulligan2007}. The rejection did not, however, stop the initiative, and a group of engineers within \gls{ietf} started designing and developing what would later be known as \gls{6lowpan}.

A significant advantage with combining \gls{ip} and 802.15.4 is the simplification of the connectivity model between various devices in the networks. As most 802.15.4-based specifications usually need custom hardware that tends to be complex, the possibilities to interconnect different networks with each other is somewhat limited. By turning to \gls{ip}, the need for complex connectivity models is obsolete as it is possible to use well-understood technologies such as bridges and routers. Another advantage with using \gls{ip} is that the routers between the \gls{6lowpan} devices and the outside networks (so-called edge routers) do not need to maintain any state as they are only forwarding datagrams.

\begin{figure}[h]
	\centering
	\includegraphics[scale=0.65]{6lowpan.png}
	\caption{Figure of the \gls{6lowpan} stack, which uses the 802.15.4 physical and link layer, but adds an adoption layer in the network layer.}
	\label{fig:6lowpan-stack}
\end{figure}

\gls{6lowpan} enables wireless 802.15.4 sensor devices to connect directly to the Internet via \gls{ip}v6 by providing an adoption layer in the network layer between it and the data link layer as shown in Figure \ref{fig:6lowpan-stack}. The adoption layer provides a unique functionality which both fragments and compresses incoming packets to enable the embedded devices in 802.15.4 networks to receive the packets while using the least amount of memory and energy \cite{krentz20136lowpan}. Its fundamental idea is that you only ``pay'' for what you use. The dispatch header field identifies the type of header to follow, and consists of 1 byte \citep{Mulligan2007}. Such a header starts with either 00 or 01, respectively indicating whether the frame is a non-\gls{6lowpan} frame or a regular \gls{6lowpan}-frame. Currently, only five different dispatch headers have been defined \cite{rfc6282}. Therefore, there is a fair space for new headers as the standard and technology evolves. However, the special case of a header consisting solely of ones, adds an additional byte to the header, enabling a total of 320 different header types \citep{Mulligan2007}. This greatly differs from \gls{ip}v4 and Zigbee which define only one monotonic header, and can be used to greatly minimize the header size of a packet as some types of frames may consist of smaller payloads than others.


Compared to other alternatives such as ZigBee or Z-wave, \gls{6lowpan}'s implementation did not prove to be any more expensive in terms of code size and \gls{ram} requirements. \gls{6lowpan} seems to be a natural choice for the future \gls{iot} as a networking protocol. It is scalable thanks to \gls{ip}v6, and its headers can be compressed to only a few bytes using its fragmentation and compression mechanism. Following the expected bloom in \gls{iot} devices over the next few years (20 billion by 2020), and the fact that the \gls{ip}v6 address space is not going to be exhausted any time soon (roughly $2^{95}$ addresses for each and every one of us), \gls{6lowpan} may be a reasonable approach.


% Dette var feil? Seff. 6LoWPAN har vel fort vekk noen m√•ter √• utf√∏re key establishment p√•

%However, as neither \gls{6lowpan} or its underlying 802.15.4 layers provide any description on how to perform key establishment and key management, which is and will be of huge importance as the global network of connected \emph{things} grows larger, we need to provide it with safe ways to communicate.


\section{Key Establishment and Key Management}
\label{sec:keyestablishment}

As described, \gls{iot} devices communicate with each other over the network by utilizing some network protocol. There is, however, not always a guarantee for that the network used for communication is secure. An attacker may be eavesdropping on the network, and may even be capable of intercepting and spoofing traffic sent between different nodes. From a security perspective, the described attacker is violating both the confidentiality and integrity of the exchanged information. To cope with this, devices should be encrypting and authenticating the data that they are exchanging. 

%Key management is essentially all aspects of managing cryptographic keys in a cryptosystem. For example the generation of keys, key exchange with other entities, secure storage, and how to use and revoke keys. 


Key establishment is a fundamental idea in cryptography where two (or more) communicating parties exchange information in order to generate cryptographic keys which enable them to perform some sort of cryptography on the messages that are sent between them. The problem is, however, how to safely agree upon the keys to use in the encryption-decryption process when the network itself can not be trusted. For \gls{iot} devices and sensor networks, confidentiality and data integrity are important aspect. As previously described, \gls{iot} devices have limited resources in terms of battery life and processing abilities, making key establishment schemes that works great in other networks with access to more resources, such as WiFi, infeasible in an \gls{iot} scenario.


%How to safely generate keys and distribute them between \gls{iot} is the main problem of the \gls{iot} security field, and 
\subsection{Symmetric Encryption}

% Symmetric key
In modern cryptography, encryption and decryption are in most cased done either by using symmetric key encryption or asymmetric key encryption. Symmetric key encryption is the case where communicating parties possesses the same key which is used for encryption as well as decryption messages that are sent between them. While being a straightforward and fast way of encrypting information, it has a major drawback in the case of one of the parties is compromised, then the channel that initially was secure would now be insecure as the adversary could easily encrypt any message that it intercepts.

\subsection{Asymmetric Encryption}

% Asymmetric key
In the 1970s, Whitfield Diffie and Martin Hellman introduced the Diffie-Hellman key exchange, which was one of the first practical examples of public key exchange within cryptography \cite{diffie1976new}. Asymmetric encryption (or public-key encryption) is the case where each communicating nodes possess a public key and a corresponding private key. The public key is published and used by anyone who wants to send an encrypted message to the node. When the node receives a message that is encrypted with its public key, it uses the private key which is generated from the public key to decrypt the message. In the (un)likely case of being compromised, the node could simply generate a new key pair consisting of a public and a private key, and publish the new public key for others to send encrypted messages under.

Of the different algorithms in use today, the \gls{rsa} cryptosystem is the most commonly used, which provides both key exchange and authentication \cite{wander2005energy}. Asymmetric encryption is significantly more computationally costly compared to symmetric encryption. This has lead to a hybrid solution where a symmetric session key is established and encrypted under the public key of each recipient, which reduces the computation time of encryption and decryption, giving a more efficient encryption scheme.

\subsection{Security Attributes in Key Establishment Schemes}

% Authentication

\subsubsection{Authentication}

Authentication is an important aspect of key establishment. More specific, confirming the identity of the entity you are establishing keys with, as well as the keys. If authentication is skipped, then the protocol will be weak for so-called man-in-the-middle attacks where an adversary intercepts and relays messages between two communicating parties to learn or modify its content. One of the traditional key exchange infrastructures for enforcing authentication in the Internet is to use a trusted third party \cite{maurer1996modelling}. Usually this third party is a secure key server that is responsible for serving cryptographic keys to users and programs. The keys that are provided by the key server is usually included in a certificate containing additional information about the identity of the owner of that particular key. Example of such systems is the well-known public key system OpenPGP \cite{openpgp}, which is used for encrypting electronic mail. For systems using symmetric encryption, authentication can be achieved through construction of \gls{mac-auth}, which are cryptographic values generated from a symmetric key and the plaintext message. This enables the receiver of a message to compute the same \gls{mac-auth} from the decrypted ciphertext and the shared symmetric key, and provides both authenticity of the sender and the integrity of the received message.

\subsubsection{Known-Key Security}

Session keys are single-use symmetric keys that are used for a given period of the communication before being exchanged and deleted from the system, and never to be used again. Known-key security is a property where the leak of information is minimized in the case of one (or multiple) session keys are compromised. For example in the case where session keys are derived from the private key, then the compromise should not lead to the compromise of the private key, nor any of the past or future session keys. 

\subsubsection{Forward Secrecy}

Following in the lines of known-key security, forward secrecy is a security attribute where in the case of the long-term private key of one (or both) of the communicating parties being compromised, it should not lead to the reveal of any of the past session keys that are used in the communication between the parties. 
The Heartbleed Bug in 2014 was a painful example of the need for forward secrecy, where a bug in the OpenSSL cryptographic software library leaked secret keys for certificates, as well as user names and passwords \cite{durumeric2014matter}. Attackers were able to retrieve 64 kilobytes of the memory of web servers for each attack (or ``heartbeat''), which could be used to retrieve the private long-term key of the web server. The private key could then be used to retroactively decrypt all traffic that had previously been recorded.

\subsubsection{Key-Compromise Impersonation}

In this case, an adversary has obtained the long-term private key of an honest entity $A$. Key-compromise impersonation prevents the adversary both from impersonating $A$ to other entities (establishing session keys with them), as well as preventing the adversary from impersonate other entities in communication with $A$ (masquerading as a different entity in order to establish a session key with $A$). In practice, a party possessing the private key of $A$ is able to decrypt both past and future traffic going to and from $A$.


\subsubsection{Key Control}

Key control is to prevent a party from computing a part of the session key without input from the other party. Essentially, one of the communicating parties should not be able to force the secret session key into something of its own choice. Key control is usually accomplished through both parties creating a random value, which is shared with the other party, and computed together into the shared key, for example in the Diffie-Hellman key exchange.

\subsubsection{Unknown Key-Share}

Unknown key-share resilience is an attribute in key agreement protocols where a key shared between two entities $A$ and $B$ can not be shared with any others without they both consenting to it. When $A$ and $B$ are establishing a shared key, attacks targeting this process may want to convince $A$ that it is sharing the key with $B$, while $B$ in fact is under the impression that it is sharing the key with a third entity $C$. 


\subsection{Key Establishment Schemes}

The simplest possible scheme for key establishment is the network-shared key scheme, where every node in the network possesses the same key which is used for encryption and decryption between all nodes in the network \cite{perrig2004security}. While being easy to set up, it leaves the network vulnerable to node compromises as wireless sensor nodes often are deployed in hostile and unattended areas, where the compromising of one node is equal to the compromising of the entire network \cite{krentz20136lowpan}. Also, in 802.15.4, the network-shared key scheme is incompatible with replay protection, moving the responsibility of implementing such measures to the higher layers \cite{sastry2004security}.

Pairwise keys is a better symmetric key scheme, where each node pair possesses their own symmetric key for communication between them. This, however, leads to higher memory requirements as the node in worst case has to store the symmetric key for $N-1$ nodes, where the number of nodes in the network can be high \cite{perrig2004security}. Group keying is another approach where groups of nodes share the same symmetric key. This greatly reduces the memory consumption for the devices, and can provide a mild version of compromise resilience. Unfortunately, group keying is not supported in \gls{ieee} 802.15.4 \cite{sastry2004security}.

Pairwise random keys is another scheme that can support the hunt for pairwise keys while still maintaining a modest memory consumption. When using such a scheme, a node only possesses a part of the pairwise keys which when added up constitutes the entire pairwise key pool. The idea of such an approach is to create a multi-hop path between nodes, essentially connecting the entire network together while eliminating the need for storing $N-1$ keys.


% Herfra m√• det bli bedre.

\subsection{Key Establishment Schemes in Wireless Sensor Networks and the Internet of Things}

When it comes to \gls{wsn} applications, symmetric encryption algorithms have historically been the most mature ones \citep{Jing2014}. However, there exists several drawbacks with technology utilizing symmetric encryption. For starters, their key exchange protocols are often complex which is a constraint for the scalability of the network. Also, as the \gls{iot} devices are placed in possible hostile environment, they may be physically tampered with by adversaries \cite{krentz20136lowpan}. If they should successfully compromise one of the nodes, then the security of the entire network may be at stake. Finally, authentication is a rather complex and inconvenient procedure with symmetric encryption involving \gls{mac-auth} which leads to higher requirements for storage space, overhead in messages, and increased energy consumption.

It has been an underlying assumption in the research community that public-key cryptography has been an unsuitable solution for key establishment and key management in \gls{wsn}s and other \gls{iot} related networks \cite{wander2005energy} \cite{gaubatz2004public}. While improving the security over symmetric key encryption, and also providing easier authentication and higher scalability, it still has issues related to energy consumption due to higher computational complexity as well as being time consuming \citep{Eschenauer2002}. However, public-key cryptography algorithms such as Rabin's Scheme, NtruEncrypt and \gls{ecc} have proven promising results when implemented efficiently for wireless platforms \cite{Jing2014} \cite{gaubatz2004public}. Especially \gls{ecc} and its implementation of \gls{ecdsa} have proven to be over four times more energy efficient than \gls{rsa}-1024 \cite{wander2005energy}. One of the main advantages with \gls{ecc} over more commonly used public-key algorithms such as \gls{rsa} is the reduced key size, which in leads to greater memory and energy savings, while providing approximate the same level of security (\gls{ecc}-160 is equivalent to \gls{rsa}-1024 in terms of cryptographic strength) \cite{nist2016}.

Bottom line, there is no scheme that provides a clear advantage over others, symmetric or asymmetric, as they all have different advantages and disadvantages. It is up to the application designer to find and implement the best suited scheme based on the infrastructure, available resources, and security demands of the particular network. 


%Last sentences are stupid. Reformulate.


%However, for \gls{wsn} and other types of sensor networks in \gls{iot}, such an approach is infeasible due to the unknown 	topology of the network, communication range constraints, complexity, and network dynamics \citep{Eschenauer2002}. A possible approach is so-called key pre-distribution, where the keys used for securing communication is implemented in the devices before deploying them in their intended environment.  This is, however, an unsafe option. Because of devices often being deployed in hostile environment where they are left unattended, they are also susceptible to be compromised by an attacker \cite{krentz20136lowpan}. The attacker may physically tamper with the device to obtain cryptographic keys, which then can be used to decrypt the communication in case of the network using a network shared key. Another scenario is in the case of the system utilizing a pairwise key scheme, where each node pair share the same symmetric key. This leads to high memory requirements and complexity for the devices, and will also make if significantly harder for new nodes to join the network.


% Key Management

%Key management is the idea of how cryptographic keys should be stored, and is one of the hardest problems in \gls{iot} security. 

%Key Management?

\section{Formal Security Analysis} 


As security protocols grows larger and more complex, they become more and more difficult for humans to analyse. One of the examples of the need for formal security analysis is the Needham-Schroeder protocol \cite{Needham:1978} from 1978. The Needham-Schroeder Public-Key Protocol is based on public-key cryptography and was intended to allow two communicating parties to mutually authenticate each other. Throughout this section, the protocol will be used as an illustrative example to underline the importance of formal security analysis.

One of the pioneering works on security analysis was conducted by Burrows, Abadi and Needham with their \gls{ban} logic. \gls{ban} logic is a set of rules which can be used to determine whether received information is trustworthy or not, by formally describing the interaction between communicating parties \cite{burrows1989logic}. It showed promising results in finding security flaws and drawbacks for several authentication protocols, but was later abandoned due to the fact that it verified insecure protocols as secure, and in some cases perfectly sound protocols to be insecure \cite{boyd1993}. One of the protocols that was formally verified using \gls{ban} logic was the Needham-Schroeder protocol.

In fact, 17 years later after being deployed and widely used, Lowe discovered using the automatic tool Casper that the Needham-Schroeder protocol was insecure, and vulnerable to a man-in-the-middle attack \cite{basin2011model} \cite{lowe1996}. The discovery of that such a flaw had gone unnoticed for so many years puzzled the research community, leading to an increased interest in formal security analysis \cite{cremers2009comparing}. Researchers started developing tools for exhaustive search of the problem space of a protocol in order to detect possible abnormalities in protocol behaviour. 


In order to conduct formal security analysis, we need a formal model to be able to study the protocol under precise assumptions. Formal security models are abstractions of descriptions of systems, aiming to improve the understanding of the security of the system by simplifying its interpretation. By defining a formal security model, we aim to discover and correct errors, incompleteness and inconsistencies in protocol specifications, before they are exploited by adversaries. A protocol specification is a description of the behaviour of the different entities that are allowed to communicate with each other during an execution of the protocol \cite{cremers2005operational}. More precise, a protocol description specifies the different roles in the protocol, each containing a sequential list of the messages that are sent and received from that particular role. It also contains the information of the initial knowledge of the protocol, which are the functions, constants and variables that the protocol needs to execute correctly. Such a specification is expressed using a formal language, which has well-defined syntax and semantics, for example process algebra, predicate logic, and lambda calculus. 


The Dolev-Yao model is a formal threat model used to prove the security properties of cryptographic protocols. While initially being a verification model built for public key protocols, the Dolev-Yao model is also the basis for most of the security analysis done by verification tools that focus on verifying secrecy and authentication properties \cite{cremers2005operational}. The model is built upon three primary assumptions: Perfect cryptography, complete control of network, and abstract terms \cite{dolev1983security}. Firstly, the Dolev-Yao model assumes that the cryptography is perfect, essentially meaning that the cryptographic system can not be tampered with, and an encrypted message can only be decrypted by the party possessing the corresponding decryption key. The second assumption is that the adversary has complete control over the communication network, hence he is able to observe all messages that are sent between communicating parties, and can inject messages given that he is able to forge its content in a valid matter. Lastly, messages that are sent in the network are to be observed as abstract terms, where the attacker has two possible outcomes; either he learns the complete content of the message, or he learns nothing at all. 


% Verification and falsification

Falsification, presented by Popper in 1934, is the theory of presenting an observation that would disprove the correctness of an alleged theory, or more informally; It is not possible to prove a theory from a single correct observation, but a single observation that contradicts the theory is enough to disprove it \cite{popper2005logic}. In model checking, the falsification process is to formally assess the security properties of the protocol in order to discover examples that disproves the claimed security by constructing counter-examples. Following in the same line of thoughts, we can perform verification by using formal models and languages to verify a statement (i.e. a security property). In formal security analysis, this is referred to as model checking, which uses the formal model to exhaustive verify whether it meets the alleged security properties \cite{basin2011model}. Verification can also be done by constructing mathematical proofs for each of the security properties, proving that the alleged security is fulfilled. 




% Goals of formal security analysis
What are good security properties? What do we want to achieve? 

Confidentiality, integrity, and availability, also known as the \gls{cia} triad, are the formal security goals 






